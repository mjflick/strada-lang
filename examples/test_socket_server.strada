# test_socket_server.strada - Simple echo server

func main() int {
    say("Starting echo server on port 8080...");
    
    my scalar $server = sys::socket_server(8080);
    
    say("Server listening. Connect with: nc localhost 8080");
    say("Waiting for client...");
    
    my scalar $client = sys::socket_accept($server);
    say("Client connected!");
    
    sys::socket_send($client, "Hello from Strada server!\n");
    
    my str $data = sys::socket_recv($client, 1024);
    say("Received: " . $data);
    
    sys::socket_send($client, "Echo: " . $data . "\n");
    
    sys::socket_close($client);
    sys::socket_close($server);
    
    say("Server done!");
    return 0;
}
