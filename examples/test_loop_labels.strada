func main() void {
    say("=== Loop Labels Demo ===");

    # Test 1: last LABEL
    say("Test 1: last OUTER");
    my int $i = 0;
    OUTER: while ($i < 5) {
        my int $j = 0;
        while ($j < 5) {
            say("i=" . $i . " j=" . $j);
            if ($j == 2) {
                last OUTER;
            }
            $j = $j + 1;
        }
        $i = $i + 1;
    }
    say("After OUTER loop");

    # Test 2: next LABEL
    say("");
    say("Test 2: next OUTER");
    $i = 0;
    OUTER2: while ($i < 3) {
        $i = $i + 1;
        my int $j = 0;
        while ($j < 3) {
            $j = $j + 1;
            if ($j == 2) {
                say("Skipping rest of inner, i=" . $i);
                next OUTER2;
            }
            say("i=" . $i . " j=" . $j);
        }
        say("End of outer iteration");
    }

    # Test 3: Unlabeled still works
    say("");
    say("Test 3: Unlabeled next/last");
    $i = 0;
    while ($i < 5) {
        $i = $i + 1;
        if ($i == 2) { next; }
        if ($i == 4) { last; }
        say("i=" . $i);
    }

    # Test 4: Labeled for loop
    say("");
    say("Test 4: Labeled for loop");
    OUTER3: for (my int $x = 0; $x < 3; $x = $x + 1) {
        for (my int $y = 0; $y < 3; $y = $y + 1) {
            say("x=" . $x . " y=" . $y);
            if ($y == 1 && $x == 1) {
                say("Breaking out of OUTER3");
                last OUTER3;
            }
        }
    }

    # Test 5: next with labeled for loop
    say("");
    say("Test 5: next with labeled for loop");
    OUTER4: for (my int $a = 0; $a < 3; $a = $a + 1) {
        for (my int $b = 0; $b < 3; $b = $b + 1) {
            if ($b == 1) {
                say("Skipping to next OUTER4 iteration at a=" . $a);
                next OUTER4;
            }
            say("a=" . $a . " b=" . $b);
        }
        say("This should not print");
    }

    say("");
    say("=== Done ===");
}
